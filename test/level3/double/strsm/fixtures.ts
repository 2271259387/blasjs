import {
    complex,
    fortranArrComplex64 as arr64,
    fortranMatrixComplex64
} from '../../../../src/lib/f_func';



import {
    diagonal_nxn,
    matrix_mxn,
    vector
} from '../../../matrices';

const pI = Infinity;
const nI = -Infinity;
const { PI, sin, cos, abs, sqrt } = Math;

const cospi = x => cos(PI * x);
const sinpi = x => sin(PI * x);


export const fixture = {
    strsm: {
        case0: {
            desc: '(trivial) n=0',
            input: {
                // DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'l',
                trans: 'n',
                diag: 'n',
                m: 3,
                n: 0,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: matrix_mxn(6, 6).real().toArr()
            },
        },
        case1: {
            desc: '(trivial) m=0',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 0,
                n: 4,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: matrix_mxn(6, 6).real().toArr()
            },
        },
        case2: {
            desc: '(near trivial) alpha=0',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 0,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    -1.5399500131607056,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    -0.79900926351547241,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    -0.89192110300064087,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case3: {
            desc: 'side="l", trans="n", uplo="u", diag="n", n=4,m=5,  alpha=0.2',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'u',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: -0.3,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    2.8760477856849080,
                    1.0674914099744215,
                    2.3099160037069781,
                    -0.83419411218394646,
                    9.6833648057177424E-002,
                    -1.5399500131607056,
                    6.0136168281204476,
                    4.8635866076512668,
                    1.8293225267512880,
                    -1.5850226571227222,
                    0.17832645474752631,
                    -0.79900926351547241,
                    -1.4371747372957879,
                    -1.6154974071937465,
                    -0.41226915389269775,
                    0.43496171252302679,
                    5.8903224779356549E-002,
                    -0.89192110300064087,
                    -0.14203359997494031,
                    -0.25518927999139956,
                    7.0263741446830702E-002,
                    -0.24298957861021067,
                    3.1138823620419129E-002,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case4: {
            desc: 'side="l", trans="n", uplo="u", diag="u", n=4,m=5,  alpha=0.2',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'u',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 5] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    4.1556304884584154,
                    1.7159749179671806,
                    1.6151643330570895,
                    1.2724293470382690,
                    0.0000000000000000,
                    -1.5399500131607056,
                    0.32527101830242566,
                    2.8982091011989999,
                    -0.17724156678261460,
                    2.9322611352921228,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -2.5763265232150987,
                    -0.89135493070048955,
                    -0.62627605662926944,
                    -0.23723605293206518,
                    0.25222346186637878,
                    -0.89192110300064087,
                    -0.80678160482835470,
                    -0.79997545952292404,
                    -0.26374106824485594,
                    0.46952493468041467,
                    0.13333636522293091,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case5: {
            desc: 'side="l", trans="n", uplo="l", diag="n", n=4,m=5,  alpha=1',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'l',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.0000000000000000,
                    1.1069247724052265,
                    -4.4656271837292438,
                    -8.5506942544560935,
                    -1.4291268756368971,
                    -1.5399500131607056,
                    -0.73523412495700569,
                    1.8138488664325891,
                    -3.2832814948133882,
                    -6.2867622079499208,
                    -1.0507428478614336,
                    -0.79900926351547241,
                    -0.90870833234224635,
                    1.9880282164136940,
                    -3.0768830449084668,
                    -14.048738644337698,
                    -1.3702608528785267,
                    -0.89192110300064087,
                    0.34497157373668497,
                    3.8171672723850882,
                    2.2091016117699600,
                    -22.076170652817265,
                    0.41888386278645928,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case6: {
            desc: 'side="l", trans="n", uplo="l", diag="u", n=4,m=5,  alpha=0.4',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'l',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.0000000000000000,
                    -0.13049334482093666,
                    0.53116714806329368,
                    1.0413440314533495,
                    -7.3214051234893329E-003,
                    -1.5399500131607056,
                    -0.37142682628969581,
                    -0.23905999868918107,
                    0.49023756215580533,
                    2.2110702137392075,
                    0.22352549776441472,
                    -0.79900926351547241,
                    -0.45906282155309341,
                    -0.26554624032184093,
                    0.48924392015425894,
                    1.2593964890024612,
                    0.20268307600853525,
                    -0.89192110300064087,
                    0.17427332660963124,
                    -0.43816161773430906,
                    -0.32398265584906044,
                    0.84951218563403830,
                    0.28409609869451813,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case7: {
            desc: 'side="l", trans="t", uplo="u", diag="n", n=4,m=5,  alpha=0.2',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 't',
                uplo: 'u',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.40000000596046448,
                    -0.81749837427995664,
                    -2.5210898556555987,
                    -3.2920006232504653,
                    -0.82757303929373927,
                    -1.5399500131607056,
                    -0.29409365436513918,
                    1.3265922592519162,
                    -0.14762614926240678,
                    7.1505702288184647,
                    -3.6755135679883280,
                    -0.79900926351547241,
                    -0.36348333835322227,
                    1.5380788827994862,
                    0.30621952409281056,
                    5.2090325188076907,
                    -2.0023835360962079,
                    -0.89192110300064087,
                    0.13798863155086480,
                    1.2448532310035869,
                    -1.4337299275752455,
                    3.4707688249874709,
                    -2.6382839997206511,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case8: {
            desc: 'side="l", trans="n", uplo="u", diag="u", n=4,m=5,  alpha=0.2',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 't',
                uplo: 'u',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 5] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    1.2629542350769043,
                    0.84650433354312327,
                    3.0242680938088427,
                    2.4480091415279279,
                    -1.9463795578177014,
                    -1.5399500131607056,
                    -0.92856705188751221,
                    -1.1569572109540474,
                    -1.4063383495193884,
                    1.0620389085996593,
                    3.5539979003076425,
                    -0.79900926351547241,
                    -1.1476570367813110,
                    -1.3551380941210738,
                    -2.0085922000010106,
                    -2.0389940391990007,
                    1.6411600347579820,
                    -0.89192110300064087,
                    0.43568331003189087,
                    -0.83297729016390321,
                    3.4632206547511479E-002,
                    -0.83549882555301869,
                    -3.7182870327288287E-002,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case9: {
            desc: 'side="l", trans="t", uplo="l", diag="n", n=4,m=5,  alpha=1',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 't',
                uplo: 'l',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    14.071953442027016,
                    28.896460512105627,
                    -9.5101901017120269,
                    3.4856455476188124,
                    -0.32277881403118042,
                    -1.5399500131607056,
                    16.647190236328399,
                    53.347344958219551,
                    -9.5336347064703304,
                    6.5817166896649049,
                    -0.59442149220489982,
                    -0.79900926351547241,
                    -4.2136696115120111,
                    -7.9010181993490969,
                    2.2387106134601513,
                    -1.0210266334602636,
                    -0.19634407479584262,
                    -0.89192110300064087,
                    3.3426373540889309,
                    12.403351630523389,
                    -0.76371010732187516,
                    1.0366718348708222,
                    -0.10379607461024500,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case10: {
            desc: 'side="l", trans="n", uplo="l", diag="u", n=4,m=5,  alpha=0.4',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 't',
                uplo: 'l',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    -2.0709179287349446,
                    -1.4238808651692094,
                    0.69043374474546071,
                    0.48685703308243111,
                    0.16585657843733692,
                    -1.5399500131607056,
                    -2.9053033457793012,
                    -2.5644010238629114,
                    0.29971185824180141,
                    0.92113542876856069,
                    0.30543737866636178,
                    -0.79900926351547241,
                    9.2468575755851989E-002,
                    0.23408160147934709,
                    -0.21840491582933022,
                    -0.17805655656779862,
                    0.10088938624992050,
                    -0.89192110300064087,
                    -0.26011598121513951,
                    -0.88189661251917384,
                    -4.3964851097145805E-002,
                    0.14384683150119362,
                    5.3334546883919032E-002,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case11: {
            desc: 'side="r", trans="n", uplo="u", diag="n", n=4,m=5,  alpha=0.4',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 'n',
                uplo: 'u',
                diag: 'n',

                n: 4, m: 5,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.40000000596046448,
                    -0.10332389028569243,
                    0.42117102183241650,
                    0.40300094196887909,
                    0.13132429808688795,
                    -1.5399500131607056,
                    -0.0000000000000000,
                    0.72553955738441744,
                    -1.3191438758939147,
                    -4.5333629735177849,
                    -1.4501226768752162,
                    -0.79900926351547241,
                    -0.0000000000000000,
                    8.1376893207696338E-002,
                    6.0717631042909850E-002,
                    3.3899755064395092,
                    0.56197083573963380,
                    -0.89192110300064087,
                    0.0000000000000000,
                    1.2351345873541026,
                    -5.0135144737906154,
                    -12.916340648551534,
                    -4.4315078463190725,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case12: {
            desc: 'side="r", trans="n", uplo="u", diag="u", n=4,m=5,  alpha=1',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 'n',
                uplo: 'u',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(2);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    1.2629542350769043,
                    -0.32623335719108582,
                    1.3297992944717407,
                    1.2724293470382690,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -0.92856705188751221,
                    -0.29472044110298157,
                    -5.7671726681292057E-003,
                    2.4046533107757568,
                    0.76359343528747559,
                    -0.79900926351547241,
                    3.2996789570152174E-002,
                    -0.74917583630662232,
                    1.2252690347217428,
                    1.7448564224390495,
                    0.94912059259529258,
                    -0.89192110300064087,
                    -1.2563020878502498,
                    -1.6281479882856154,
                    -0.53598784626494267,
                    3.1901856372673363,
                    1.1105175198176607,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case13: {
            desc: 'side="r", trans="n", uplo="l", diag="n", n=4,m=5,  alpha=1',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 'n',
                uplo: 'l',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(2);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.70564268894473470,
                    -9.4021146266978111,
                    -1.5183813183635133,
                    0.0000000000000000,
                    1.4536198850814033,
                    -1.5399500131607056,
                    12.525932259284879,
                    -25.862121989332273,
                    -4.8645484671667072,
                    -0.0000000000000000,
                    0.31775908685034171,
                    -0.79900926351547241,
                    2.2478463015809740,
                    5.4772264960486572,
                    1.8172744690943989,
                    -0.0000000000000000,
                    -1.3288531503707177,
                    -0.89192110300064087,
                    1.1544470606667443,
                    -3.2791539201836617,
                    -0.59425136281649238,
                    1.0000000000000000,
                    0.35330656779194236,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case14: {
            desc: 'side="r", trans="n", uplo="l", diag="u", n=4,m=5,  alpha=0.4',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 'n',
                uplo: 'l',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(3);
                    m.r[col1 + 4] = 0;
                    return m;
                })(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.63514348901234075,
                    1.0030009359941672,
                    0.87461970167237335,
                    0.73083684628214940,
                    2.1823395109519889E-002,
                    -1.5399500131607056,
                    -0.79314125265886570,
                    1.0717844686128233,
                    0.21271748897692591,
                    0.59790974261275354,
                    0.17776813043410594,
                    -0.79900926351547241,
                    -0.45906282155309341,
                    -0.11578463488496293,
                    -0.11968604504594271,
                    -0.16460433251566187,
                    0.10088938624992050,
                    -0.89192110300064087,
                    0.17427332660963124,
                    -0.49501539014302764,
                    -8.9707155372309000E-002,
                    0.15095826612350738,
                    5.3334546883919032E-002,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case15: {
            desc: 'side="l", trans="t", uplo="u", diag="n", n=4,m=5,  alpha=0.2',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 't',
                uplo: 'u',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(4);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.12265160515110517,
                    4.4958660707110338,
                    1.2686519464434949,
                    -3.1847383241640368,
                    -1.1496261325400379,
                    -1.5399500131607056,
                    -1.8456630500063393,
                    4.5620681112929500,
                    0.43809281388119808,
                    -5.1890953824761556,
                    -1.1945825060805559,
                    -0.79900926351547241,
                    1.1881106602650842,
                    1.3700785619373967,
                    0.57816146198746388,
                    0.25031215036191640,
                    -0.44310434134787979,
                    -0.89192110300064087,
                    0.46177883114773843,
                    -1.3116615876187452,
                    -0.23770054866861109,
                    0.40000000596046448,
                    0.14132262922264818,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case16: {
            desc: 'side="r", trans="t", uplo="u", diag="u", n=4,m=5,  alpha=1',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 't',
                uplo: 'u',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(4);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    -0.58581143455533968,
                    -2.8251275929335362,
                    0.57166729880208988,
                    3.4759940329914816,
                    1.6765266814553499,
                    -1.5399500131607056,
                    -0.69331159718403756,
                    -1.9903470874821614,
                    -0.38447736812125505,
                    2.7770777485476015,
                    1.0102671058949777,
                    -0.79900926351547241,
                    -1.0499472622719184,
                    -0.56700171534803268,
                    -0.34951119243846152,
                    -0.32687309871784231,
                    0.28212652650036940,
                    -0.89192110300064087,
                    0.43568331003189087,
                    -1.2375384569168091,
                    -0.22426788508892059,
                    0.37739565968513489,
                    0.13333636522293091,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case17: {
            desc: 'side="r", trans="t", uplo="l", diag="n", n=4,m=5,  alpha=1',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 't',
                uplo: 'l',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 2] = 0;
                    return m;
                })(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    1.0000000000000000,
                    -0.25830972186511630,
                    1.0529275388911983,
                    1.0075023399092429,
                    0.32831074032500862,
                    -1.5399500131607056,
                    3.1506706776509308,
                    1.0000000000000000,
                    1.9568281882809863E-002,
                    -8.1590991848967818,
                    -2.5909076154668886,
                    -0.79900926351547241,
                    8.2191233076063988,
                    -0.19987518688139722,
                    5.6791402122517267,
                    6.0101967138102479,
                    0.66609651430713834,
                    -0.89192110300064087,
                    -13.330197021871951,
                    -8.9978822302334489,
                    1.9235222679509523,
                    56.143957802321914,
                    16.481176946121465,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case18: {
            desc: 'side="r", trans="t", uplo="l", diag="u", n=4,m=5,  alpha=0.4',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'r',
                trans: 't',
                uplo: 'l',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 2] = 0;
                    return m;
                })(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.50518170155855557,
                    -0.13049334482093666,
                    0.53191972571491775,
                    0.50897174639957754,
                    0.16585657843733692,
                    -1.5399500131607056,
                    -0.37142682628969581,
                    -0.11788817819786335,
                    -2.3068691016267101E-003,
                    0.96186133864315337,
                    0.30543737866636178,
                    -0.79900926351547241,
                    -1.1329951745064821,
                    5.7065441511977961E-002,
                    -0.82704582512967395,
                    -0.83588738136111684,
                    -0.11790506463747739,
                    -0.89192110300064087,
                    -4.1621727652003587E-002,
                    -2.2008583670317005E-002,
                    -1.1013285141596649,
                    -3.1535920793264705,
                    -0.94069644520301565,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },


    },
    strsmErrors: {
        case0: {
            desc: 'side !="lr"',
            input: {
                side: 'x',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 4,
                alpha: 0,
                lda: 6,
                ldb: 6
            }
        },
        case1: {
            desc: 'uplo !="ul"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'x',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case2: {
            desc: 'trans!="ntc"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'x',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case3: {
            desc: 'diag!="un"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'x',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case4: {
            desc: 'm<0"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: -3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case5: {
            desc: 'n<0',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: -5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case6: {
            desc: 'lda< max(1,nrowA)',
            input: {
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 2,
                ldb: 6,
            }
        },
        case7: {
            desc: 'ldb < max(1,m)',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 3,
            }
        },
    }
}

