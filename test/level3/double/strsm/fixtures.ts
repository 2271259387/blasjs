import {
    complex,
    fortranArrComplex64 as arr64,
    fortranMatrixComplex64
} from '../../../../src/lib/f_func';



import {
    diagonal_nxn,
    matrix_mxn,
    vector
} from '../../../matrices';

const pI = Infinity;
const nI = -Infinity;
const { PI, sin, cos, abs, sqrt } = Math;

const cospi = x => cos(PI * x);
const sinpi = x => sin(PI * x);


export const fixture = {
    strsm: {
        case0: {
            desc: '(trivial) n=0',
            input: {
                // DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'l',
                trans: 'n',
                diag: 'n',
                m: 3,
                n: 0,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: matrix_mxn(6, 6).real().toArr()
            },
        },
        case1: {
            desc: '(trivial) m=0',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 0,
                n: 4,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: matrix_mxn(6, 6).real().toArr()
            },
        },
        case2: {
            desc: '(near trivial) alpha=0',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 0,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    -1.5399500131607056,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    -0.79900926351547241,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    -0.89192110300064087,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case3: {
            desc: 'side="l", trans="n", uplo="u", diag="n", n=4,m=5,  alpha=0.2',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'u',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: -0.3,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    2.8760477856849080,
                    1.0674914099744215,
                    2.3099160037069781,
                    -0.83419411218394646,
                    9.6833648057177424E-002,
                    -1.5399500131607056,
                    6.0136168281204476,
                    4.8635866076512668,
                    1.8293225267512880,
                    -1.5850226571227222,
                    0.17832645474752631,
                    -0.79900926351547241,
                    -1.4371747372957879,
                    -1.6154974071937465,
                    -0.41226915389269775,
                    0.43496171252302679,
                    5.8903224779356549E-002,
                    -0.89192110300064087,
                    -0.14203359997494031,
                    -0.25518927999139956,
                    7.0263741446830702E-002,
                    -0.24298957861021067,
                    3.1138823620419129E-002,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case4: {
            desc: 'side="l", trans="n", uplo="u", diag="u", n=4,m=5,  alpha=0.2',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'u',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 5] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    4.1556304884584154,
                    1.7159749179671806,
                    1.6151643330570895,
                    1.2724293470382690,
                    0.0000000000000000,
                    -1.5399500131607056,
                    0.32527101830242566,
                    2.8982091011989999,
                    -0.17724156678261460,
                    2.9322611352921228,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -2.5763265232150987,
                    -0.89135493070048955,
                    -0.62627605662926944,
                    -0.23723605293206518,
                    0.25222346186637878,
                    -0.89192110300064087,
                    -0.80678160482835470,
                    -0.79997545952292404,
                    -0.26374106824485594,
                    0.46952493468041467,
                    0.13333636522293091,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case5: {
            desc: 'side="l", trans="n", uplo="l", diag="n", n=4,m=5,  alpha=1',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'l',
                diag: 'n',
                m: 5,
                n: 4,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.0000000000000000,
                    1.1069247724052265,
                    -4.4656271837292438,
                    -8.5506942544560935,
                    -1.4291268756368971,
                    -1.5399500131607056,
                    -0.73523412495700569,
                    1.8138488664325891,
                    -3.2832814948133882,
                    -6.2867622079499208,
                    -1.0507428478614336,
                    -0.79900926351547241,
                    -0.90870833234224635,
                    1.9880282164136940,
                    -3.0768830449084668,
                    -14.048738644337698,
                    -1.3702608528785267,
                    -0.89192110300064087,
                    0.34497157373668497,
                    3.8171672723850882,
                    2.2091016117699600,
                    -22.076170652817265,
                    0.41888386278645928,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case6: {
            desc: 'side="l", trans="n", uplo="l", diag="u", n=4,m=5,  alpha=0.4',
            input: {
                //DTRSM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                trans: 'n',
                uplo: 'l',
                diag: 'u',
                m: 5,
                n: 4,
                alpha: 0.4,
                lda: 6,
                ldb: 6,
                b: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col1 = m.colOfEx(1);
                    m.r[col1 + 1] = 0;
                    return m;
                })(),
                a: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: [
                    0.0000000000000000,
                    -0.13049334482093666,
                    0.53116714806329368,
                    1.0413440314533495,
                    -7.3214051234893329E-003,
                    -1.5399500131607056,
                    -0.37142682628969581,
                    -0.23905999868918107,
                    0.49023756215580533,
                    2.2110702137392075,
                    0.22352549776441472,
                    -0.79900926351547241,
                    -0.45906282155309341,
                    -0.26554624032184093,
                    0.48924392015425894,
                    1.2593964890024612,
                    0.20268307600853525,
                    -0.89192110300064087,
                    0.17427332660963124,
                    -0.43816161773430906,
                    -0.32398265584906044,
                    0.84951218563403830,
                    0.28409609869451813,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },


    },
    strsmErrors: {
        case0: {
            desc: 'side !="lr"',
            input: {
                side: 'x',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 4,
                alpha: 0,
                lda: 6,
                ldb: 6
            }
        },
        case1: {
            desc: 'uplo !="ul"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'x',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case2: {
            desc: 'trans!="ntc"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'x',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case3: {
            desc: 'diag!="un"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'x',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case4: {
            desc: 'm<0"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: -3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case5: {
            desc: 'n<0',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: -5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case6: {
            desc: 'lda< max(1,nrowA)',
            input: {
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 2,
                ldb: 6,
            }
        },
        case7: {
            desc: 'ldb < max(1,m)',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 3,
            }
        },
    }
}

