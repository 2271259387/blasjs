import {
    complex,
    fortranArrComplex64 as arr64,
    fortranMatrixComplex64
} from '../../../../src/lib/f_func';



import {
    diagonal_nxn,
    matrix_mxn,
    vector
} from '../../../matrices';

const pI = Infinity;
const nI = -Infinity;
const { PI, sin, cos, abs, sqrt } = Math;

const cospi = x => cos(PI * x);
const sinpi = x => sin(PI * x);


export const fixture = {
    ssyrk: {
        case0: {
            desc: '(trivial) n=0',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 't',
                n: 0,
                k: 3,
                alpha: 0.2,
                beta: 1,
                lda: 6,
                ldc: 6,
                a: matrix_mxn(6, 6).real(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: matrix_mxn(6, 6).real().toArr()
            },
        },
        case1: {
            desc: '(trivial) k=0, beta=1',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 't',
                n: 5,
                k: 0,
                alpha: 0.2,
                beta: 1,
                lda: 6,
                ldc: 6,
                a: matrix_mxn(6, 6).real(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: matrix_mxn(6, 6).real().toArr()
            },
        },
        case2: {
            desc: '(near trivial) uplo="l",alpha=0 beta=0.25',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 't',
                n: 5,
                k: 3,
                alpha: 0,
                beta: 0.25,
                lda: 6,
                ldc: 6,
                a: matrix_mxn(6, 6).real(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [0.31573855876922607,
                    -8.1558339297771454E-002,
                    0.33244982361793518,
                    0.31810733675956726,
                    0.10366035997867584,
                    -1.5399500131607056,
                    -0.92856705188751221,
                    -7.3680110275745392E-002,
                    -1.4417931670323014E-003,
                    0.60116332769393921,
                    0.19089835882186890,
                    -0.79900926351547241,
                    -1.1476570367813110,
                    -0.28946158289909363,
                    -7.4803777039051056E-002,
                    -0.10287770628929138,
                    6.3055865466594696E-002,
                    -0.89192110300064087,
                    0.43568331003189087,
                    -1.2375384569168091,
                    -0.22426788508892059,
                    9.4348914921283722E-002,
                    3.3334091305732727E-002,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -0.32114982604980469,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680
                ]
            },
        },
        case3: {
            desc: '(near trivial) uplo="u",alpha=0 beta=0',
            input: {
                cmd: 'xdebug',
                uplo: 'u',
                trans: 't',
                n: 5,
                k: 3,
                alpha: 0,
                beta: 0,
                lda: 6,
                ldc: 6,
                a: matrix_mxn(6, 6).real(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [
                    0.0000000000000000,
                    -0.32623335719108582,
                    1.3297992944717407,
                    1.2724293470382690,
                    0.41464143991470337,
                    -1.5399500131607056,
                    0.0000000000000000,
                    0.0000000000000000,
                    -5.7671726681292057E-003,
                    2.4046533107757568,
                    0.76359343528747559,
                    -0.79900926351547241,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    -0.41151082515716553,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.13333636522293091,
                    0.80418950319290161,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    0.0000000000000000,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case4: {
            desc: 'trans="n", uplo="u",alpha=0.5 beta=0',
            input: {
                cmd: 'xdebug',
                uplo: 'u',
                trans: 'n',
                n: 5,
                k: 3,
                alpha: 0.5,
                beta: 0,
                lda: 6,
                ldc: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    m.r[0] = 0;
                    return m;
                })(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [
                    1.0896767219623626,
                    -0.32623335719108582,
                    1.3297992944717407,
                    1.2724293470382690,
                    0.41464143991470337,
                    -1.5399500131607056,
                    0.30293515680899219,
                    0.13853817486127573,
                    -5.7671726681292057E-003,
                    2.4046533107757568,
                    0.76359343528747559,
                    -0.79900926351547241,
                    0.17437576545445990,
                    -0.17275695285948342,
                    0.92896455240352616,
                    -0.41151082515716553,
                    0.25222346186637878,
                    -0.89192110300064087,
                    -0.88030427069764272,
                    -0.50234640364711325,
                    0.90066892658162279,
                    3.7853875737252878,
                    0.13333636522293091,
                    0.80418950319290161,
                    -0.49925686794892066,
                    -0.21666273278065828,
                    0.23575852432294281,
                    1.1299933669898525,
                    0.40930956641226368,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case5: {
            desc: 'trans="n",uplo="l",alpha=0.5 beta=0.1',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 'n',
                n: 5,
                k: 3,
                alpha: 0.5,
                beta: 0.1,
                lda: 6,
                ldc: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    m.r[0] = 0;
                    return m;
                })(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [
                    1.2159721473520015,
                    0.27031182060375802,
                    0.30735569688318931,
                    -0.75306133409774834,
                    -0.45779272333958643,
                    -1.5399500131607056,
                    -0.92856705188751221,
                    0.10906613031180989,
                    -0.17333367013489009,
                    -0.26188106898632491,
                    -0.14030338811406784,
                    -0.79900926351547241,
                    -1.1476570367813110,
                    -0.28946158289909363,
                    0.89904304114204048,
                    0.85951784345270732,
                    0.26098087088542293,
                    -0.89192110300064087,
                    0.43568331003189087,
                    -1.2375384569168091,
                    -0.22426788508892059,
                    3.8231271402561644,
                    1.1433270037108323,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    0.28084963407813968,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case6: {
            desc: 'trans="n",uplo="u",alpha=0.5 beta=1',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 'n',
                n: 5,
                k: 3,
                alpha: 0.5,
                beta: 1,
                lda: 6,
                ldc: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    m.r[0] = 0;
                    return m;
                })(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [
                    2.3526309570392669,
                    -2.3298200382093626E-002,
                    1.5041750599262007,
                    0.39212507634062632,
                    -8.4615428034217288E-002,
                    -1.5399500131607056,
                    -0.92856705188751221,
                    -0.15618226624170584,
                    -0.17852412552761263,
                    1.9023069071286436,
                    0.54693070250681730,
                    -0.79900926351547241,
                    -1.1476570367813110,
                    -0.28946158289909363,
                    0.62974944424732193,
                    0.48915810142445731,
                    0.48798198618932154,
                    -0.89192110300064087,
                    0.43568331003189087,
                    -1.2375384569168091,
                    -0.22426788508892059,
                    4.1627832334104227,
                    1.2633297322127834,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -0.87528973778695507,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case7: {
            desc: 'trans="t",uplo="u",alpha=0.5 beta=1',
            input: {
                cmd: 'xdebug',
                uplo: 'u',
                trans: 't',
                n: 5,
                k: 3,
                alpha: 0.5,
                beta: 1,
                lda: 6,
                ldc: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    m.r[0] = 0;
                    return m;
                })(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [
                    2.2003514185377573,
                    -0.32623335719108582,
                    1.3297992944717407,
                    1.2724293470382690,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -0.88432782349316796,
                    0.17984464316481136,
                    -5.7671726681292057E-003,
                    2.4046533107757568,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -1.2993890446585055,
                    0.28689460800591537,
                    0.44600207334231445,
                    -0.41151082515716553,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.48843083507645613,
                    -1.2568084045324375,
                    -0.26161330330681420,
                    1.2632043913204543,
                    0.13333636522293091,
                    0.80418950319290161,
                    0.58267406427225765,
                    0.45277902880236237,
                    0.88321202139700339,
                    -1.1367628165609722,
                    -0.56671059822693159,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case8: {
            desc: 'trans="t",uplo="l",alpha=0.5 beta=1',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 't',
                n: 5,
                k: 3,
                alpha: 0.5,
                beta: 1,
                lda: 6,
                ldc: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    m.r[0] = 0;
                    return m;
                })(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [
                    2.2003514185377573,
                    -0.28199412879674157,
                    1.1780672865945463,
                    1.3251768720828343,
                    1.0544222784872979,
                    -1.5399500131607056,
                    -0.92856705188751221,
                    0.17984464316481136,
                    0.57058901823687980,
                    2.3853833631601282,
                    0.71276447573229396,
                    -0.79900926351547241,
                    -1.1476570367813110,
                    -0.28946158289909363,
                    0.44600207334231445,
                    -0.44885624337505914,
                    4.9666068361648774E-002,
                    -0.89192110300064087,
                    0.43568331003189087,
                    -1.2375384569168091,
                    -0.22426788508892059,
                    1.2632043913204543,
                    -0.31247260059188642,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -0.56671059822693159,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case9: {
            desc: 'trans="t",uplo="l",alpha=0.5 beta=-.3',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 't',
                n: 5,
                k: 3,
                alpha: 0.5,
                beta: -0.3,
                lda: 6,
                ldc: 6,
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    m.r[0] = 0;
                    return m;
                })(),
                c: matrix_mxn(6, 6).real(),
            },
            expect: {
                c: [
                    0.55851089788219399,
                    0.14210923944067463,
                    -0.55067181207115956,
                    -0.32898129423545530,
                    0.51538840165527233,
                    -1.5399500131607056,
                    -0.92856705188751221,
                    0.56298122011202878,
                    0.57808634277419779,
                    -0.74066596951405672,
                    -0.27990699924416734,
                    -0.79900926351547241,
                    -1.1476570367813110,
                    -0.28946158289909363,
                    0.83498171751230199,
                    8.6107834234847358E-002,
                    -0.27822443507138162,
                    -0.89192110300064087,
                    0.43568331003189087,
                    -1.2375384569168091,
                    -0.22426788508892059,
                    0.77259002923087217,
                    -0.48580987697118994,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    1.1032685125456698,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },

    },
    ssyrkErrors: {
        case0: {
            desc: 'uplo !="ul"',
            input: {
                cmd: 'xdebug',
                uplo: 'x',
                trans: 't',
                n: 6,
                k: 3,
                alpha: 0,
                beta: 0,
                lda: 6,
                ldc: 6
            }
        },
        case1: {
            desc: 'trans!="ntc"',
            input: {
                cmd: 'xdebug',
                uplo: 'l',
                trans: 'x',
                n: 6,
                k: 3,
                alpha: 0.2,
                beta: 0.3,
                lda: 6,
                ldc: 6
            }
        },
        case2: {
            desc: 'n<0"',
            input: {
                cmd: 'xdebug',
                trans: 'n',
                uplo: 'u',
                k: 3,
                n: -6,
                lda: 6,
                ldc: 6,
                beta: 0.2,
                alpha: 0.3
            }
        },
        case3: {
            desc: 'k<0',
            input: {
                cmd: 'xdebug',
                trans: 'n',
                uplo: 'u',
                k: -6,
                n: 4,
                lda: 6,
                ldc: 6,
                beta: 0.2,
                alpha: 0.3
            }
        },
        case4: {
            desc: 'lda< max(1,nrowA)',
            input: {
                cmd: 'xdebug',
                trans: 't',
                uplo: 'u',
                k: 3,
                n: 6,
                lda: 2,
                ldc: 6,
                beta: 0.2,
                alpha: 0.3
            }
        },
        case6: {
            desc: 'ldc< max(1,n)',
            input: {
                cmd: 'xdebug',
                trans: 't',
                uplo: 'u',
                k: 3,
                n: 6,
                lda: 6,
                ldc: 5,
                beta: 0.2,
                alpha: 0.3
            }
        },
    }
}

