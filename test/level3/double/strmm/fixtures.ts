import {
    complex,
    fortranArrComplex64 as arr64,
    fortranMatrixComplex64
} from '../../../../src/lib/f_func';



import {
    diagonal_nxn,
    matrix_mxn,
    vector
} from '../../../matrices';

const pI = Infinity;
const nI = -Infinity;
const { PI, sin, cos, abs, sqrt } = Math;

const cospi = x => cos(PI * x);
const sinpi = x => sin(PI * x);


export const fixture = {
    strmm: {
        case0: {
            desc: '(trivial) n=0',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 0,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: matrix_mxn(6, 6).real().toArr()
            },
        },
        case1: {
            desc: '(trivial) m=0',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 0,
                n: 4,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: matrix_mxn(6, 6).real().toArr()
            },
        },
        case2: {
            desc: '(near trivial) alpha=0',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: matrix_mxn(6, 6).real(),
            },
            expect: {
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    for (let j = 1; j <= 5; j++) {
                        m.setCol(j, 1, 4, 0);
                    }
                    return m.toArr();
                })()
            },
        },
        case3: {
            desc: 'side="l", uplo="u", trans="n", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    -0.13376955027205623,
                    -0.37269168964382426,
                    -0.13665221769762764,
                    9.6041863996781870E-002,
                    0.41464143991470337,
                    -1.5399500131607056,
                    3.1043210583502262E-002,
                    -0.57746429546569267,
                    -0.10751217903927630,
                    0.18150114721142990,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.20330918310617146,
                    0.13623640118971414,
                    3.6363669221485505E-002,
                    -3.1060480328389754E-002,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.42423863127033090,
                    -7.4793651950806062E-003,
                    -3.5066774415492968E-003,
                    2.8485497214302609E-002,
                    0.13333636522293091,
                    0.80418950319290161,
                    -0.41737700574272668,
                    7.8473973225458224E-002,
                    -3.3983971328727602E-002,
                    -5.2152597640000117E-002,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case4: {
            desc: 'side="l", uplo="u", trans="n", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    -0.13376955027205623,
                    -0.45716789012760756,
                    0.20888685428993503,
                    0.25448587319978877,
                    0.41464143991470337,
                    -1.5399500131607056,
                    7.9877339080526827E-002,
                    -0.65378041250427499,
                    -0.10901073863396238,
                    0.48093066932157669,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.14295292655930192,
                    6.1282034414110703E-002,
                    -4.1385289758090887E-002,
                    -8.2302166257830933E-002,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.40132567662385932,
                    -0.32793263733445327,
                    -6.1781123226259227E-002,
                    7.5479133061753689E-002,
                    0.13333636522293091,
                    0.80418950319290161,
                    -0.41437371206720319,
                    0.20888028653451660,
                    0.24814563843818194,
                    -0.13819077220843390,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case5: {
            desc: 'side="l", uplo="u", trans="n", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'l',
                trans: 'n',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.0000000000000000,
                    1.9229528073314964E-002,
                    -7.9202920304291768E-002,
                    -0.17029912545531151,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -0.23454754164187250,
                    7.7957938185309453E-002,
                    -0.24627649999048579,
                    -0.19607149801135446,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.28988766732341625,
                    9.1942852051560969E-002,
                    -0.28699089666230115,
                    -0.43770788469578115,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.11004961795128716,
                    4.4518690863499522E-002,
                    0.13072256109808894,
                    -0.43735172082496909,
                    0.13333636522293091,
                    0.80418950319290161,
                    -1.4424648705782278E-002,
                    -2.5958687141488187E-002,
                    -8.0744712265704510E-002,
                    8.6153887050131550E-002,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case6: {
            desc: 'side="l", uplo="l", trans="n", diag="u"',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'l',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.0000000000000000,
                    -6.5246672410468332E-002,
                    0.26633615168327091,
                    -1.1855116252304621E-002,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -0.18571341314484791,
                    1.6418211467271876E-003,
                    -0.24777505958517188,
                    0.10335802409879236,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.22953141077654671,
                    1.6988485275957532E-002,
                    -0.36473985564187755,
                    -0.48894957062522237,
                    0.25222346186637878,
                    -0.89192110300064087,
                    8.7136663304815620E-002,
                    -0.27593458127587311,
                    7.2448115313379025E-002,
                    -0.39035808497751801,
                    0.13333636522293091,
                    0.80418950319290161,
                    -1.1421355030258817E-002,
                    0.10444762616757018,
                    0.20138489750120506,
                    1.1571248169774985E-004,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case7: {
            desc: 'side="l", uplo="u", trans="t", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 't',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.0000000000000000,
                    1.9229528073314964E-002,
                    -6.0692804055271013E-002,
                    0.11714087432900773,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -0.23454754164187250,
                    0.18981938447952956,
                    0.23054247979735421,
                    0.17379316805032069,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.28988766732341625,
                    0.23019735475348149,
                    0.29808687704124803,
                    -4.5998647838143239E-002,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.11004961795128716,
                    -7.9666574884085968E-003,
                    -1.4938167509753483E-002,
                    0.38280899514826189,
                    0.13333636522293091,
                    0.80418950319290161,
                    -1.4424648705782278E-002,
                    -1.9079220167672776E-002,
                    -8.1022958609228146E-002,
                    -0.23047618662315555,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case8: {
            desc: 'side="l", uplo="u", trans="t", diag="u" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 't',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.0000000000000000,
                    -6.5246672410468332E-002,
                    0.28484626793229167,
                    0.27558488353201460,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -0.18571341314484791,
                    0.11350326744094730,
                    0.22904392020266814,
                    0.47322269016046747,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.22953141077654671,
                    0.15524298797787806,
                    0.22033791806167161,
                    -9.7240333767584411E-002,
                    0.25222346186637878,
                    -0.89192110300064087,
                    8.7136663304815620E-002,
                    -0.32841992962778122,
                    -7.3212613294463408E-002,
                    0.42980263099571292,
                    0.13333636522293091,
                    0.80418950319290161,
                    -1.1421355030258817E-002,
                    0.11132709314138559,
                    0.20110665115768139,
                    -0.31651436119158932,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case9: {
            desc: 'side="l", uplo="u", trans="t", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'l',
                trans: 't',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.69877417243773476,
                    0.62964598915695558,
                    -0.18430290080139067,
                    9.6041863996781870E-002,
                    0.41464143991470337,
                    -1.5399500131607056,
                    0.39509844751508305,
                    1.1738502062335965,
                    -0.19756305153203721,
                    0.18150114721142990,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.45530416304997412,
                    -0.18050100219891524,
                    5.1774168805587273E-002,
                    -3.1060480328389754E-002,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.22719049228029489,
                    0.25470540260658808,
                    -1.7639612229834328E-002,
                    2.8485497214302609E-002,
                    0.13333636522293091,
                    0.80418950319290161,
                    6.5649696488754752E-002,
                    -0.36323797600371394,
                    -8.1087248501193320E-003,
                    -5.2152597640000117E-002,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case10: {
            desc: 'side="l", uplo="l", trans="t", diag="u"',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'l',
                uplo: 'l',
                trans: 't',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.69877417243773476,
                    0.54516978867317223,
                    0.16123617118617201,
                    0.25448587319978877,
                    0.41464143991470337,
                    -1.5399500131607056,
                    0.44393257601210767,
                    1.0975340891950143,
                    -0.19906161112672330,
                    0.48093066932157669,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.39494790650310457,
                    -0.25545536897451870,
                    -2.5974790173989123E-002,
                    -8.2302166257830933E-002,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.20427753763382334,
                    -6.5747869532784525E-002,
                    -7.5914058014544261E-002,
                    7.5479133061753689E-002,
                    0.13333636522293091,
                    0.80418950319290161,
                    6.8652990164278213E-002,
                    -0.23283166269465555,
                    0.27402088491679022,
                    -0.13819077220843390,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case11: {
            desc: 'side="r", uplo="u", trans="n", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'u',
                trans: 'n',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                a: matrix_mxn(6, 6).real(),
                b: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(1);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.0000000000000000,
                    -8.2403561245476389E-002,
                    0.33589513515630032,
                    0.32140401132491730,
                    0.41464143991470337,
                    -1.5399500131607056,
                    5.4733539040789828E-002,
                    7.7957938185309453E-002,
                    -0.24662162503435850,
                    -0.37804729602655435,
                    0.76359343528747559,
                    -0.79900926351547241,
                    0.12243616443525157,
                    0.10926510807652637,
                    -0.28699089666230115,
                    -0.40664740436739144,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.31418901331904370,
                    -3.5906251399439898E-002,
                    0.11379501555798423,
                    -0.43735172082496915,
                    0.13333636522293091,
                    0.80418950319290161,
                    -0.38828049231206169,
                    -4.7186895994017958E-002,
                    -0.32870869118119039,
                    0.26367365687583844,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case12: {
            desc: 'side="r", uplo="u", trans="n", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                b: matrix_mxn(6, 6).real(),
                a: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(5);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.25259085077927779,
                    -6.5246672410468332E-002,
                    0.26595986285745887,
                    0.25448587319978877,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -0.42026095478672043,
                    1.6418211467271876E-003,
                    -0.24811500032477099,
                    0.24462347229742959,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.46566217956546202,
                    3.4050534609079502E-002,
                    -0.36473985564187755,
                    -0.51357562220354913,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.47849029604446414,
                    -0.19000561661229257,
                    8.5868983411934455E-002,
                    -0.39035808497751806,
                    0.13333636522293091,
                    0.80418950319290161,
                    -0.41437371206720319,
                    0.17919557239783579,
                    0.18258903603362686,
                    -3.7504017834857878E-002,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case13: {
            desc: 'side="r", uplo="l", trans="n", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'l',
                trans: 'n',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                b: matrix_mxn(6, 6).real(),
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col = m.colOfEx(1);
                    m.r[col + 2] = 0;
                    return m;
                })()
            },
            expect: {
                b: [
                    0.11991945712012861,
                    -0.43256143005126935,
                    0.28928391752242805,
                    0.25070089192710987,
                    0.41464143991470337,
                    -1.5399500131607056,
                    0.25686948050218156,
                    -0.50055394354600868,
                    5.8645043662170243E-002,
                    -6.5285867462874403E-002,
                    0.76359343528747559,
                    -0.79900926351547241,
                    2.9940851977806920E-002,
                    0.14457870228456704,
                    9.1134974160671095E-002,
                    -4.1289383714462335E-002,
                    0.25222346186637878,
                    -0.89192110300064087,
                    3.1362116565027028E-002,
                    -7.9978477925575386E-002,
                    1.2026964341996193E-002,
                    1.0059641940680018E-002,
                    0.13333636522293091,
                    0.80418950319290161,
                    1.4671864724882723E-002,
                    -0.12938689621466881,
                    -0.27895573113747618,
                    0.17751976982570691,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case14: {
            desc: 'side="r", uplo="l", trans="n", diag="u"',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'l',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                b: matrix_mxn(6, 6).real(),
                a: (() => {
                    const m = matrix_mxn(6, 6).real();
                    const col = m.colOfEx(1);
                    m.r[col + 2] = 0;
                    return m;
                })()
            },
            expect: {
                b: [
                    5.3499623166039158E-002,
                    -0.41540454121626136,
                    0.21934864522358660,
                    0.18378275380198134,
                    0.41464143991470337,
                    -1.5399500131607056,
                    1.6422528316543793E-002,
                    -0.57687006058459112,
                    5.7151668371757752E-002,
                    0.55738490086110959,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -0.26826982469949034,
                    6.9364128817120160E-002,
                    1.3386015181094696E-002,
                    -0.14821760155062005,
                    0.25222346186637878,
                    -0.89192110300064087,
                    8.5613781339160269E-002,
                    -0.23407784313842803,
                    -1.5899067804053583E-002,
                    5.7053277788131102E-002,
                    0.13333636522293091,
                    0.80418950319290161,
                    -1.1421355030258817E-002,
                    0.10072159917237755,
                    0.21715388621619169,
                    -0.13819077220843390,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case15: {
            desc: 'side="r", uplo="u", trans="t", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'u',
                trans: 't',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                b: matrix_mxn(6, 6).real(),
                a: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(2);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.62105025011110615,
                    -0.12954989323526214,
                    0.37263148789538547,
                    0.45663529934264102,
                    0.41464143991470337,
                    -1.5399500131607056,
                    7.5872070510040876E-003,
                    0.39115412276144135,
                    0.18253065588284567,
                    -0.28091909034151730,
                    0.76359343528747559,
                    -0.79900926351547241,
                    3.6736352739085119E-002,
                    0.18219071514324656,
                    0.26374420144354255,
                    -0.14234480784734793,
                    0.25222346186637878,
                    -0.89192110300064087,
                    4.0776627769578674E-002,
                    -0.16300230666012616,
                    -0.16697085942567472,
                    0.12396894340930473,
                    0.13333636522293091,
                    0.80418950319290161,
                    1.4671864724882723E-002,
                    -0.12938689621466881,
                    -0.27895573113747618,
                    0.17751976982570691,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case16: {
            desc: 'side="r", uplo="u", trans="t", diag="u" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'u',
                trans: 't',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: matrix_mxn(6, 6).real(),
                a: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(2);
                    m.r[col + 1] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    2.7731520394618983,
                    -0.56196501362733908,
                    1.5134810554300948,
                    1.9485857770513717,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -1.1642987083237655,
                    1.5741900051570363,
                    0.90518638947383767,
                    1.7087583644498494,
                    0.76359343528747559,
                    -0.79900926351547241,
                    -1.3073716002097058,
                    0.53488070040865487,
                    0.92997619846210555,
                    -1.2463651098452408,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.47514145563840016,
                    -1.5855083357389788,
                    -0.97448444333767270,
                    0.85481288354607443,
                    0.13333636522293091,
                    0.80418950319290161,
                    -5.7106774300336838E-002,
                    0.50360798835754395,
                    1.0857694149017334,
                    -0.69095385074615479,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case17: {
            desc: 'side="r", uplo="l", trans="t", diag="n" ',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'l',
                trans: 't',
                diag: 'n',
                m: 4,
                n: 5,
                alpha: 0.2,
                lda: 6,
                ldb: 6,
                b: matrix_mxn(6, 6).real(),
                a: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(4);
                    m.r[col + 5] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    0.31901068473336724,
                    -8.2403561245476389E-002,
                    0.33589513515630032,
                    0.32140401132491730,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -2.7670022204686562E-002,
                    3.8657668925664676E-002,
                    -8.6425038198470444E-002,
                    -0.22476187977407930,
                    0.76359343528747559,
                    -0.79900926351547241,
                    0.40564544237744482,
                    -6.9102782173505045E-002,
                    0.37158582649847066,
                    0.36026757600105430,
                    0.25222346186637878,
                    -0.89192110300064087,
                    2.1672963295202297E-003,
                    -0.29434689431172434,
                    0.34334003046094957,
                    1.5426405492670858,
                    0.13333636522293091,
                    0.80418950319290161,
                    -8.0296251354088660E-002,
                    -0.21605199061834265,
                    -0.18465232000306878,
                    0.62951712335693322,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },
        case18: {
            desc: 'side="r", uplo="l", trans="t", diag="u"',
            input: {
                //DTRMM(SIDE,UPLO,TRANSA,DIAG,M,N,ALPHA,A,LDA,B,LDB)
                //cmd: 'xdebug',
                side: 'r',
                uplo: 'l',
                trans: 't',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 1,
                lda: 6,
                ldb: 6,
                b: matrix_mxn(6, 6).real(),
                a: (() => {
                    const m = matrix_mxn(6, 6);
                    const col = m.colOfEx(4);
                    m.r[col + 5] = 0;
                    return m.real();
                })()
            },
            expect: {
                b: [
                    1.2629542350769043,
                    -0.32623335719108582,
                    1.3297992944717407,
                    1.2724293470382690,
                    0.41464143991470337,
                    -1.5399500131607056,
                    -1.3405848519753505,
                    -0.18829223775881498,
                    -0.43959206089398251,
                    1.9895444131030011,
                    0.76359343528747559,
                    -0.79900926351547241,
                    0.53717382049622420,
                    -0.72158676745227890,
                    1.4691843157019191,
                    1.2666967719492299,
                    0.25222346186637878,
                    -0.89192110300064087,
                    0.28209480131472731,
                    -2.2422312642110356,
                    1.5770699680743250,
                    7.9481708071357104,
                    0.13333636522293091,
                    0.80418950319290161,
                    -0.53194734761951779,
                    7.0282522796227376E-002,
                    1.5572864635476189,
                    1.5690328832335503,
                    -1.2845993041992188,
                    4.6726170927286148E-002,
                    -0.23570655286312103,
                    -0.54288828372955322,
                    -0.43331032991409302,
                    -0.64947164058685303,
                    0.72675073146820068,
                    1.1519117355346680,
                ]
            },
        },

    },
    strmmErrors: {
        case0: {
            desc: 'side !="lr"',
            input: {
                cmd: 'xdebug',
                side: 'x',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case1: {
            desc: 'uplo !="ul"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'x',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case2: {
            desc: 'trans!="ntc"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'x',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case3: {
            desc: 'diag!="un"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'x',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case4: {
            desc: 'm<0"',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: -3,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case5: {
            desc: 'n<0',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: -5,
                alpha: 0.25,
                lda: 6,
                ldb: 6,
            }
        },
        case6: {
            desc: 'lda< max(1,nrowA)',
            input: {
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 3,
                n: 5,
                alpha: 0.25,
                lda: 2,
                ldb: 6,
            }
        },
        case7: {
            desc: 'ldb< max(1,m)',
            input: {
                cmd: 'xdebug',
                side: 'l',
                uplo: 'u',
                trans: 'n',
                diag: 'u',
                m: 4,
                n: 5,
                alpha: 0.25,
                lda: 6,
                ldb: 3,
            }
        },
    }
}

